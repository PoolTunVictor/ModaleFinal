<div class="inventory-page">

  <h1 class="title">GESTI√ìN DE INVENTARIO</h1>
  <p class="subtitle">Administra tu inventario</p>

  <div class="search-box compact">

    <span class="material-symbols-outlined">search</span>

    <input
      type="text"
      class="search-input"
      placeholder="Buscar..."
      [(ngModel)]="searchTerm"
      (input)="filterProducts()"
    />

    <select
      class="category-filter"
      [(ngModel)]="selectedCategory"
      (change)="filterProducts()"
    >
      <option value="all">Todas</option>
      <option value="1">Maquillaje</option>
      <option value="2">Perfumes</option>
      <option value="3">Prendas</option>
      <option value="4">Cuidado facial</option>
      <option value="5">Cuidado corporal</option>
      <option value="6">Accesorios</option>
    </select>

    <span
      class="material-symbols-outlined clear"
      (click)="clearSearch()"
    >
    </span>

  </div>

  <!-- Card -->
  <div class="inventory-card">

    <div class="inventory-header">
      <span class="header-title">PRODUCTOS</span>
    </div>

    <p *ngIf="loading">Cargando productos...</p>
    <p *ngIf="errorMessage" class="error">{{ errorMessage }}</p>

    <table
      class="inventory-table"
      *ngIf="!loading && filteredProducts.length > 0"
    >
      <thead>
        <tr>
          <th>Producto</th>
          <th>Slug</th>
          <th>Categor√≠a</th>
          <th>Descripci√≥n</th>
          <th class="center">Stock</th>
          <th class="center">Precio</th>
          <th class="center">Acciones</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let product of filteredProducts">

          <td class="product-cell">
            <div>
              <strong>{{ product.name }}</strong>
              <small>{{ product.slug }}</small>
            </div>
          </td>

          <td>{{ product.slug }}</td>

          <td class="center">
            {{ getCategoryName(product.category_id) }}
          </td>

          <td>{{ product.description || '‚Äî' }}</td>

          <td class="center">{{ product.stock }}</td>

          <td class="center">${{ product.price }}</td>

          <td class="center actions">
            <button class="btn edit" (click)="openEditModal(product)">‚úèÔ∏è</button>
            <button class="btn delete" (click)="openDeleteModal(product)">üóëÔ∏è</button>
          </td>

        </tr>
      </tbody>
    </table>

    <p *ngIf="!loading && filteredProducts.length === 0">
      No hay productos que coincidan con la b√∫squeda.
    </p>

  </div>
</div>

<!-- üóëÔ∏è Modal eliminar -->
<div class="modal-backdrop" *ngIf="showDeleteModal">
  <div class="modal">
    <h3>Eliminar producto</h3>
    <p>
      ¬øSeguro que deseas eliminar
      <strong>{{ productToDelete?.name }}</strong>?
    </p>

    <div class="modal-actions">
      <button class="btn cancel" (click)="closeDeleteModal()">Cancelar</button>
      <button class="btn delete" (click)="confirmDelete()">Eliminar</button>
    </div>
  </div>
</div>

<!-- ‚úèÔ∏è Modal editar -->
<div class="modal-backdrop" *ngIf="showEditModal">
  <div class="modal">
    <h3>Editar producto</h3>
    <p>
      Vas a editar el producto
      <strong>{{ productToEdit?.name }}</strong>
    </p>

    <div class="modal-actions">
      <button class="btn cancel" (click)="closeEditModal()">Cancelar</button>
      <button class="btn edit" (click)="closeEditModal()">Continuar</button>
    </div>
  </div>
</div>
