<div class="reports-page">

  <h1 class="title">GESTIÓN DE REPORTES</h1>
  <p class="subtitle">Administra tus reportes.</p>

  <p *ngIf="isLoading">Cargando reportes...</p>

  <!-- KPIs -->
  <div class="kpis" *ngIf="!isLoading && report">

    <div class="kpi-card">
      <span class="kpi-title">VENTAS TOTALES</span>
      <span class="kpi-value green">
        ${{ report.total_sales | number:'1.2-2' }}
      </span>
    </div>

    <div class="kpi-card">
      <span class="kpi-title">ÓRDENES</span>
      <span class="kpi-value">{{ report.total_orders }}</span>
    </div>

    <div class="kpi-card" *ngIf="report.top_product">
      <span class="kpi-title">PRODUCTO TOP</span>
      <span class="kpi-value green">
        {{ report.top_product.name }}
      </span>
      <span class="kpi-sub">
        {{ report.top_product.units }} vendidos
      </span>
    </div>

    <div class="kpi-card" *ngIf="report.least_product">
      <span class="kpi-title">MENOS VENDIDO</span>
      <span class="kpi-value">
        {{ report.least_product.name }}
      </span>
      <span class="kpi-sub">
        {{ report.least_product.units }} vendidos
      </span>
    </div>

  </div>

  <!-- FILTRO DE TABLA -->
  <div class="table-filter" *ngIf="report">
    <label>Mostrar:</label>
    <select [(ngModel)]="tableMode" (change)="applyTableMode()">
      <option value="top">Top productos</option>
      <option value="least">Menos vendidos</option>
      <option value="all">Todos</option>
    </select>
  </div>

  <!-- TABLA -->
  <div class="table-card" *ngIf="!isLoading && report">
    <h3>Productos con Mejor Rendimiento</h3>

    <table class="products-table">
      <thead>
        <tr>
          <th>Producto</th>
          <th>Unidades Vendidas</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let p of displayedProducts">
          <td><strong>{{ p.name }}</strong></td>
          <td>{{ p.units }}</td>
        </tr>
      </tbody>
    </table>
  </div>

</div>
